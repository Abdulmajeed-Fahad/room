/* ===========================
   THEME TOKENS (Light/Dark)
   =========================== */
:root{
  --background:#ffffff; --foreground:#0f172a; --card:#ffffff; --border:#e2e8f0; --muted:#64748b;
  --primary:#3b82f6; --primary-600:#2563eb;
  --success:#10b981; --warning:#f59e0b; --danger:#ef4444;
  --security-primary:#6366f1; --security-bg:#f0f9ff; --security-border:#bfdbfe;

  /* Sensor accents for charts (تأثير فقط على الرسوم) */
  --temperature:#3b82f6; --humidity:#10b981; --light:#8b5cf6; --door:#0ea5e9;

  /* لون موحد لقيم الأرقام والحالة داخل البطاقات */
  --value-text: color-mix(in oklab, var(--foreground) 92%, transparent);
}

[data-theme="dark"]{
  --background:#0b1224; --foreground:#f1f5f9; --card:#141c2f; --border:#2b3856; --muted:#94a3b8;
  --primary:#3b82f6; --primary-600:#2f6de0;
  --success:#10b981; --warning:#f59e0b; --danger:#ef4444;
  --security-primary:#8b5cf6; --security-bg:#111a2f; --security-border:#334155;

  --temperature:#60a5fa; --humidity:#34d399; --light:#a78bfa; --door:#38bdf8;
  --value-text: color-mix(in oklab, var(--foreground) 90%, transparent);
}

/* Reset / base */
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%}
body{font-family:"Cairo",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--background);color:var(--foreground);line-height:1.6;display:flex;flex-direction:column;transition:background .3s,color .3s}
.container{max-width:1200px;margin:0 auto;padding:0 1rem}
[dir="rtl"]{text-align:right}[dir="ltr"]{text-align:left}

/* Header */
.header{position:sticky;top:0;z-index:100;background:color-mix(in oklab, var(--card) 92%, transparent);backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
.header-content{display:flex;align-items:center;justify-content:space-between;gap:1rem;min-height:64px}
.user-welcome{font-weight:800;color:var(--primary)}
.dashboard-title{flex:1;text-align:center}
.dashboard-title h1{font-size:1.4rem;font-weight:900;background:linear-gradient(135deg,var(--primary),var(--success));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.header-controls{display:flex;align-items:center;gap:.6rem;min-width:300px;justify-content:flex-end}
.connection-status{display:flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background:var(--card);border:1px solid var(--border);border-radius:.5rem;font-size:.85rem;font-weight:900}
.status-indicator{width:.65rem;height:.65rem;border-radius:50%;background:var(--success);box-shadow:0 0 8px color-mix(in oklab, var(--success) 55%, transparent);animation:pulse 2s infinite}
.status-indicator.disconnected{background:var(--danger);animation:none}
.status-indicator.connecting{background:var(--warning);animation:blink 1s infinite}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.55;transform:scale(1.15)}}
@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:.35}}
.control-btn{display:flex;align-items:center;gap:.5rem;padding:.6rem .8rem;background:transparent;border:1px solid var(--border);border-radius:.55rem;color:var(--foreground);cursor:pointer;transition:.2s;font-size:.85rem;font-weight:900}
.control-btn:hover{background:var(--card);transform:translateY(-1px)}
.digital-clock{padding:.55rem .9rem;background:var(--card);border:1px solid var(--border);border-radius:.5rem;font-family:"Courier New",monospace;font-weight:900}

/* Alert banner */
.alert-banner{background:linear-gradient(135deg,var(--security-bg),#e0f2fe);border-bottom:1px solid var(--security-border);padding:.8rem 0}
[data-theme="dark"] .alert-banner{background:linear-gradient(135deg,var(--security-bg),#0b3a74)}
.alert-content{display:flex;align-items:center;justify-content:space-between;gap:1rem}
.close-alert{background:none;border:none;color:var(--security-primary);cursor:pointer;padding:.2rem .4rem;border-radius:.25rem;font-size:1.4rem;font-weight:900}
.hidden{display:none !important}

/* Layout sections */
.main-content{flex:1;padding:2rem 0}
.main-content>.container>*+*{margin-top:2rem}

/* Mode toggle */
.mode-toggle-card{background:var(--card);border:1px solid var(--border);border-radius:.9rem;padding:1.5rem 1.25rem;box-shadow:0 8px 18px rgb(0 0 0 / .08);transition:.2s}
.mode-buttons{display:flex;align-items:center;justify-content:center;gap:1rem;margin-bottom:1rem}
.mode-btn{display:flex;align-items:center;gap:.6rem;padding:.9rem 1.4rem;background:transparent;border:2px solid var(--border);border-radius:.8rem;color:var(--foreground);cursor:pointer;transition:.2s;font-size:1rem;font-weight:900}
.mode-btn:hover{transform:translateY(-1px)}
.mode-btn.active{background:linear-gradient(135deg,var(--primary),var(--primary-600));color:#fff;border-color:transparent}
.mode-btn.security-active{background:linear-gradient(135deg,var(--security-primary),#4f46e5);color:#fff;border-color:transparent}
.mode-divider{font-size:1.4rem;font-weight:900;color:var(--muted)}
.mode-status{text-align:center}
.mode-status p{font-size:.95rem;font-weight:900;color:var(--success);padding:.55rem 1rem;background:color-mix(in oklab, var(--success) 16%, transparent);border:1px solid color-mix(in oklab, var(--success) 35%, transparent);border-radius:.5rem;display:inline-block}
.mode-status.security-status p{color:var(--security-primary);background:color-mix(in oklab, var(--security-primary) 14%, transparent);border-color:color-mix(in oklab, var(--security-primary) 35%, transparent)}

/* Cards */
.cards-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:1.2rem}
.sensor-card{background:var(--card);border:1px solid var(--border);border-radius:.9rem;padding:1.25rem;box-shadow:0 1px 3px rgb(0 0 0 / .06);transition:.2s}
.sensor-card:hover{transform:translateY(-1px)}
.sensor-card.normal{outline:2px solid color-mix(in oklab,var(--success) 30%, transparent)}
.sensor-card.warning{outline:2px solid color-mix(in oklab,var(--warning) 35%, transparent)}
.sensor-card.danger{outline:2px solid color-mix(in oklab,var(--danger) 35%, transparent)}
.sensor-card.offline{opacity:.9}

/* أيقونات البطاقات */
#temperatureCard .card-icon svg{stroke:var(--temperature)}
#humidityCard .card-icon svg{stroke:var(--humidity)}
#lightCard .card-icon svg{stroke:var(--light)}
#doorCard .card-icon svg{stroke:var(--door)}

.card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.85rem}
.card-title{font-size:.85rem;font-weight:900;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
.card-content{margin-bottom:.7rem}

/* توحيد لون النص للقيم والحالة (إلغاء تلوين بحسب النوع) */
.sensor-value{font-size:2.2rem;font-weight:900;margin-bottom:.55rem;font-family:"Courier New",monospace;color:var(--value-text)}
.sensor-value.normal,.sensor-value.warning,.sensor-value.danger{color:var(--value-text)}
.sensor-value.offline{color:var(--muted)}

.live-indicator{display:flex;align-items:center;gap:.45rem}
.pulse-dot{width:.7rem;height:.7rem;background:var(--success);border-radius:50%;animation:pulse 2.2s infinite}
.pulse-dot.offline{background:var(--muted);animation:none}
.live-text{font-size:.72rem;color:var(--muted);font-weight:800;text-transform:uppercase;letter-spacing:.06em}
.last-reading-info{margin-top:.4rem;padding:.45rem;background:color-mix(in oklab, var(--primary) 10%, transparent);border-radius:.45rem;border:1px dashed color-mix(in oklab, var(--primary) 35%, transparent)}
.last-reading-label{font-size:.72rem;color:var(--primary);font-weight:800;text-align:center;display:block}

/* Stats in card */
.daily-stats{display:grid;grid-template-columns:1fr 1fr;gap:.6rem;padding-top:.8rem;border-top:1px solid var(--border)}
.stat-item{display:flex;flex-direction:column;align-items:center;text-align:center;padding:.5rem;background:color-mix(in oklab,var(--card) 85%, transparent);border-radius:.55rem;border:1px solid var(--border)}
.stat-label{font-size:.72rem;color:var(--muted);font-weight:900;margin-bottom:.2rem;text-transform:uppercase;letter-spacing:.06em}
.stat-value{font-size:.88rem;font-weight:900;color:var(--foreground);font-family:"Courier New",monospace}

/* Events / Alerts */
.status-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(480px,1fr));gap:1.2rem}
.status-card{background:var(--card);border:1px solid var(--border);border-radius:.9rem;padding:1.2rem;box-shadow:0 6px 14px rgb(0 0 0 / .06)}
.alerts-card{border-color:var(--security-primary)}
.status-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.8rem;padding-bottom:.7rem;border-bottom:1px solid var(--border)}
.clear-btn{padding:.45rem .9rem;background:linear-gradient(135deg,var(--security-primary),#4f46e5);color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:.85rem;font-weight:900;transition:.15s}
.clear-btn:hover{transform:translateY(-1px)}
.status-content{height:18rem;overflow-y:auto}
.events-list,.alerts-list{display:flex;flex-direction:column;gap:.7rem}
.event-item,.alert-item{display:flex;align-items:center;gap:.9rem;padding:.85rem;background:var(--card);border-radius:.6rem;border:1px solid var(--border);transition:.15s}
.event-item:hover,.alert-item:hover{transform:translateY(-2px);border-color:var(--primary);box-shadow:0 6px 12px rgb(0 0 0 / .08)}
.event-icon svg{width:22px;height:22px;display:block}
.event-item.temperature .event-icon svg,
.alert-item.temperature .event-icon svg{stroke:var(--temperature)}
.event-item.humidity .event-icon svg,
.alert-item.humidity .event-icon svg{stroke:var(--humidity)}
.event-item.light .event-icon svg,
.alert-item.light .event-icon svg{stroke:var(--light)}
.event-item.door .event-icon svg,
.alert-item.door .event-icon svg{stroke:var(--door)}
.event-content{flex:1;min-width:0}
.event-message{font-size:.9rem;font-weight:800;margin-bottom:.15rem;line-height:1.35}
.event-time{font-size:.78rem;color:var(--muted);font-weight:800}
.no-events,.no-alerts{text-align:center;color:var(--muted);padding:2.2rem 1rem;font-size:.95rem;font-weight:800}

/* Charts */
.charts-card{background:var(--card);border:1px solid var(--border);border-radius:.95rem;padding:1.5rem;box-shadow:0 8px 18px rgb(0 0 0 / .06)}
.charts-header{margin-bottom:1.4rem;text-align:center}
.charts-header h3{font-size:1.4rem;font-weight:900;background:linear-gradient(135deg,var(--primary),var(--success));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.charts-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1.4rem}
.chart-container{background:var(--card);border-radius:.9rem;padding:1rem;border:2px solid var(--border);transition:.2s}
.chart-container:hover{border-color:var(--primary)}
.chart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.7rem}
.chart-header h4{font-size:.95rem;font-weight:900;color:var(--muted);text-transform:uppercase;letter-spacing:.06em}
.chart-container canvas{width:100%;height:250px;border:1px dashed var(--border);border-radius:.7rem;background:var(--background)}

/* Tooltip */
.chart-tooltip{position:fixed;background:var(--card);border:1px solid var(--border);border-radius:.6rem;padding:.6rem .75rem;box-shadow:0 10px 16px rgb(0 0 0 / .12);z-index:1000;font-size:.88rem;max-width:260px;pointer-events:none}
.tooltip-title{font-weight:900;color:var(--primary);margin-bottom:.2rem}
.tooltip-value{font-weight:900;font-size:1rem;margin-bottom:.2rem}
.tooltip-time{color:var(--muted);font-size:.78rem}

/* Footer */
.footer{background:var(--card);border-top:1px solid var(--border);padding:1.2rem 0;margin-top:2rem}
.footer p{text-align:center;color:var(--muted);font-size:.9rem}
.footer a{color:var(--primary);text-decoration:none;font-weight:900}
.footer a:hover{color:var(--success);text-decoration:underline}

/* Responsive */
@media (max-width:1200px){.cards-grid{grid-template-columns:repeat(2,1fr)}.charts-grid{grid-template-columns:1fr}}
@media (max-width:768px){
  .header-content{flex-direction:column;gap:.8rem;padding:.6rem 0}
  .dashboard-title{order:-1}.dashboard-title h1{font-size:1.2rem}
  .header-controls{flex-wrap:wrap;justify-content:center;min-width:auto}
  .cards-grid,.status-grid{grid-template-columns:1fr}
  .mode-buttons{flex-direction:column;gap:.7rem}.mode-divider{display:none}
  .mode-btn{width:100%;justify-content:center}
  .daily-stats{grid-template-columns:1fr}
  .stat-item{flex-direction:row;justify-content:space-between}
}
@media (max-width:480px){
  .container{padding:0 .8rem}
  .sensor-card,.status-card,.charts-card{padding:1rem}
  .sensor-value{font-size:1.9rem}
}
